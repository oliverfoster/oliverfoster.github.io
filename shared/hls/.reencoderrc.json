{
  "description": "Converts src files into 3 different hls v7 qualities for interactive videos",
  "inputDir": "./src",
  "outputDir": "./build",
  "clearOutputDir": true,
  "concurrency": 1,
  "default": "",
  "parameters": [
    "-y",
    "-hwaccel", "auto",
    "-i", "@@inputDir/**/*@(.mp4|.mov|.avi|.wmv)",
    "-filter_complex", "[0:v]split=3[low][medium][high];[low]scale=trunc(oh*a/2)*2:320[lowout];[medium]scale=trunc(oh*a/2)*2:640[mediumout];[high]scale=trunc(oh*a/2)*2:1080[highout]",

    "-map", "[lowout]",
    "-c:v:0", "libx264",
    "-profile:v:0", "main",
    "-maxrate:v:0", "0.8M",
    "-bufsize:v:0", "2M",
    "-crf:v:0", 23,
    "-r:v:0", 25,
    "-preset", "slow",
    "-sc_threshold", 0,
    "-keyint_min", 48,
    "-start_number", 0,

    "-map", "[mediumout]",
    "-c:v:1", "libx264",
    "-profile:v:1", "high",
    "-maxrate:v:1", "0.8M",
    "-bufsize:v:1", "2M",
    "-crf:v:1", 23,
    "-r:v:1", 25,
    "-preset", "slow",
    "-sc_threshold", 0,
    "-keyint_min", 48,
    "-start_number", 0,

    "-map", "[highout]",
    "-c:v:2", "libx264",
    "-profile:v:2", "high",
    "-maxrate:v:2", "2.5M",
    "-bufsize:v:2", "2M",
    "-crf:v:2", 23,
    "-r:v:2", 25,
    "-preset", "slow",
    "-sc_threshold", 0,
    "-keyint_min", 48,
    "-start_number", 0,


    "-map", "a:0",
    "-c:a:0", "aac",
    "-b:a:0", "98k",
    "-ac:a:0", 1,

    "-map", "a:0",
    "-c:a:1", "aac",
    "-b:a:1", "128k",
    "-ac:a:1", 1,

    "-map", "a:0",
    "-c:a:2", "aac",
    "-b:a:2", "192k",
    "-ac:a:2", 2,


    "-hls_playlist_type", "vod",
    "-hls_flags", "single_file",
    "-hls_list_size", 0,
    "-hls_segment_type", "fmp4",
    "-hls_allow_cache", 1,
    "-hls_fmp4_init_filename", "stream_%v.mp4",
    "-hls_segment_filename", "@@outputDir/@@inputFileDir/@@inputFileNameSanitizedLowerCase/stream_%vd.ts",
    "-master_pl_name", "streams.m3u8",
    "-var_stream_map", "v:0,a:0 v:1,a:1 v:2,a:2",
    "@@outputDir/@@inputFileDir/@@inputFileNameSanitizedLowerCase/stream_%v.m3u8"
  ]
}
